@inject SignInManager<ApplicationUser> signInManager;
@inject IAuthorizationService authorization
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>@ViewData["Title"] - Lecture-Room Mgt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="~/Theme/plugins/fontawesome-free/css/all.min.css">
    <link href="~/Theme/plugins/IonIcons/ionicons.min.css" rel="stylesheet" />
    <link href="~/Theme/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/lib/datatable-fixedColumns/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Theme/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="~/Theme/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <link href="~/custom/css/Datatable.css" rel="stylesheet" />
    <link href="~/lib/toastr.js/toastr.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="~/Theme/plugins/jquery/jquery-3.4.1.min.js"></script>
    <script src="~/lib/jquery-validate/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/dist/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Theme/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/Theme/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatable-fixedColumns/js/dataTables.fixedColumns.min.js"></script>
    <script src="~/Theme/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/Theme/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <script src="~/Theme/dist/js/adminlte.min.js"></script>
    <script src="~/Theme/dist/js/demo.js"></script>
    <script src="~/lib/toastr.js/toastr.min.js"></script>


</head>
<body class="hold-transition sidebar-mini layout-fixed">

    <div class="wrapper">

        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
                </li>
            </ul>

            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="user-panel" data-toggle="dropdown">
                        <img src="~/Resources/DefaultUserBlack.png" alt="User Avatar" class="brand-image img-circle elevation-3 mr-2" style="opacity: .8">
                        <span class="mr-3">@User.Identity.Name</span>
                    </a>

                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right mt-2">
                        <div class="card card-widget widget-user">
                            <div class="widget-user-header text-white" style="background: url('../../Resources/Uploads/School/ProfileWidget.png') center center;">
                                <h6 class="text-right">-----------------</h6>
                            </div>
                            <div class="widget-user-image">
                                <img class="img-circle" src="~/Resources/DefaultUserBlack.png" alt="User Avatar">
                            </div>
                            <div class="card-footer">
                                <div class="row">
                                    <div class="col-10 offset-1">
                                        <a class="btn btn-app">
                                            <i class="fas fa-id-badge"></i> Profile
                                        </a>

                                        <a class="btn btn-app">
                                            <i class="fas fa-user-clock"></i> Reminders
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <form method="post" asp-controller="Account" asp-action="LogOut">
                            <button type="submit" class="btn btn-danger btn-lg btn-block btn-sm">Sign out</button>
                        </form>

                    </div>
                </li>
            </ul>
        </nav>

        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            @if (HttpContextAccessor.HttpContext.Session.GetString("_UserType") == "I")
            {
                <a href="@Url.Action("Index","Home")" class="brand-link">
                    <img src="~/Resources/Uploads/University/UniPicture.png" alt="School Logo" class="brand-image img-circle elevation-3"
                         style="opacity: .8">
                    @*<span class="brand-text font-weight-light">@HttpContextAccessor.HttpContext.Session.GetString("_UniversityShortName")</span>*@
                </a>

            }
            else
            {
                <a href="@Url.Action("IndexLecturer","Home")" class="brand-link">
                    <img src="~/Resources/Uploads/University/UniPicture.png" alt="School Logo" class="brand-image img-circle elevation-3"
                         style="opacity: .8">
                    @*<span class="brand-text font-weight-light">@HttpContextAccessor.HttpContext.Session.GetString("_UniversityShortName")</span>*@
                </a>

            }


            <div class="sidebar">
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">

                        @*     Staff Only    *@
                        @if ((await authorization.AuthorizeAsync(User, "StaffOnly")).Succeeded)
                        {
                            <li class="nav-item">
                                <a href="@Url.Action("Index","Staff")" class="nav-link">
                                    <i class="nav-icon fas fa-portrait"></i>
                                    <p>
                                        Profile
                                    </p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="@Url.Action("IndexAccount","Staff")" class="nav-link">
                                    <i class="nav-icon fas fa-user-circle"></i>
                                    <p>
                                        Account
                                    </p>
                                </a>
                            </li>

                        }


                        @*     Administration Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "Administration")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-users-cog"></i>
                                    <p>
                                        Administration
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "ViewUser")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexUsers","Admin")" class="nav-link">
                                                <i class="fas fa-users nav-icon"></i>
                                                <p>Users</p>
                                            </a>
                                        </li>

                                    }
                                    @*@if ((await authorization.AuthorizeAsync(User, "ViewRole")).Succeeded)
                    {
                        <li class="nav-item ml-4">
                            <a href="@Url.Action("IndexRoles","Admin")" class="nav-link">
                                <i class="fas fa-user-tag nav-icon"></i>
                                <p>Roles</p>
                            </a>
                        </li>

                    }*@
                                    @if ((await authorization.AuthorizeAsync(User, "ViewUniversity")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexUniversity","Admin")" class="nav-link">
                                                <i class="fas fa-school nav-icon"></i>
                                                <p>University Info</p>
                                            </a>
                                        </li>

                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "ViewLoginProfiles")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexTempLogin","Admin")" class="nav-link">
                                                <i class="nav-icon far fa-address-card"></i>
                                                <p>Login Profiles</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>
                        }


                        @*     Basic Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "BasicData")).Succeeded)
                        {
                            <li class="nav-item">
                                <a href="@Url.Action("IndexBasic","BasicData")" class="nav-link">
                                    <i class="nav-icon fas fa-globe"></i>
                                    <p>
                                        Basic Data
                                    </p>
                                </a>
                            </li>
                        }


                        @*     Staff Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "Staff")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="" class="nav-link">
                                    <i class="nav-icon fas fa-user-friends"></i>
                                    <p>
                                        Staff-Profile
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">

                                    @if ((await authorization.AuthorizeAsync(User, "ViewStaff")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexEmployee","Staff")" class="nav-link">
                                                <i class="nav-icon fas fa-restroom"></i>
                                                <p>Manage Staff</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>

                        }


                        @*Lecturer Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "Lecturer")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-user-tie"></i>
                                    <p>
                                        Lecturer
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "CreateLecturer")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexLecturer","Lecturer")" class="nav-link">
                                                <i class="fas fa-user-plus nav-icon"></i>
                                                <p>Register</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "ViewLecturer")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("Index","Lecturer")" class="nav-link">
                                                <i class="fas fa-users-cog nav-icon"></i>
                                                <p>Manage Lecturers</p>
                                            </a>
                                        </li>
                                    }
                                    @*@if ((await authorization.AuthorizeAsync(User, "ViewLecturer")).Succeeded)
                    {
                        <li class="nav-item ml-4">
                            <a href="@Url.Action("Index","LecturerFaculty")" class="nav-link">
                                <i class="fas fa-users-cog nav-icon"></i>
                                <p>Lecturer Faculties</p>
                            </a>
                        </li>
                    }*@

                                </ul>
                            </li>

                        }


                        @*     Lecturer Only    *@
                        @if ((await authorization.AuthorizeAsync(User, "LecturersOnly")).Succeeded)
                        {
                            <li class="nav-item">
                                <a href="@Url.Action("RegisterLecturer","Lecturer")" class="nav-link">
                                    <i class="nav-icon fas fa-portrait"></i>
                                    <p>
                                        My Profile
                                    </p>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="@Url.Action("IndexAccount","Lecturer")" class="nav-link">
                                    <i class="nav-icon fas fa-user-circle"></i>
                                    <p>
                                        Account
                                    </p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="@Url.Action("Index","LecturerCourse")" class="nav-link">
                                    <i class="nav-icon fas fa-user-circle"></i>
                                    <p>
                                        My Courses
                                    </p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="@Url.Action("IndexRoomStatus","RoomStatus")" class="nav-link">
                                    <i class="nav-icon fas fa-user-circle"></i>
                                    <p>
                                        Booking Summary
                                    </p>
                                </a>
                            </li>

                            @*<li class="nav-item">
                <a href="@Url.Action("IndexInsertByLec","LecturerFaculty")" class="nav-link">
                    <i class="nav-icon fas fa-user-circle"></i>
                    <p>
                        Basic Data
                    </p>
                </a>
            </li>*@
                        }


                        @*     Events Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "Events")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-calendar-check"></i>
                                    <p>
                                        Events
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">

                                    @if ((await authorization.AuthorizeAsync(User, "ViewEvent")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexMasterEvents","Events")" class="nav-link">
                                                <i class="nav-icon fas fa-globe"></i>
                                                <p>Events Basic-Data</p>
                                            </a>
                                        </li>
                                    }

                                    @if ((await authorization.AuthorizeAsync(User, "ViewUniversityEvent")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexEvents","Events")" class="nav-link">
                                                <i class="nav-icon far fa-calendar-plus"></i>
                                                <p>University Events</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "ViewCalender")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexCalender","Events")" class="nav-link">
                                                <i class="nav-icon far fa-calendar-alt"></i>
                                                <p>Calender View</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>

                        }


                        @*     Course Tab    *@
                        @if ((await authorization.AuthorizeAsync(User, "Courses")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="" class="nav-link">
                                    <i class="nav-icon fas fa-book"></i>
                                    <p>
                                        Courses
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "RegisterCourse")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("CourseIndex","Course")" class="nav-link">
                                                <i class="nav-icon fas fa-globe"></i>
                                                <p>Course Registration</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>

                        }


                        @*Faculties Blcoks Floors Tab*@
                        @if ((await authorization.AuthorizeAsync(User, "Building")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-building"></i>
                                    <p>
                                        Building
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "RegisterFacsBlcoks")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("BuildingRegIndex","BuildingRegistration")" class="nav-link">
                                                <i class="fas fa-city nav-icon"></i>
                                                <p>Faculty-Blocks Registration</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "RegisterBlcoks")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("BlockIndex","Blocks")" class="nav-link">
                                                <i class="fas fa-warehouse nav-icon"></i>
                                                <p>Block Registration</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "RegisterFloors")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("FloorIndex","Floors")" class="nav-link">
                                                <i class="fas fa-landmark nav-icon"></i>
                                                <p>Floor Registration</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>

                        }


                        @if ((await authorization.AuthorizeAsync(User, "Room")).Succeeded)
                        {
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-landmark"></i>
                                    <p>
                                        Room
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "RoomTypes")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("RoomTypeIndex","RoomType")" class="nav-link">
                                                <i class="fas fa-globe nav-icon"></i>
                                                <p>Room Types</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "FacultyCategories")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("Index","FacilityCategory")" class="nav-link">
                                                <i class="fas fa-globe nav-icon"></i>
                                                <p>Facility Categories</p>
                                            </a>
                                        </li>
                                    }
                                    @if ((await authorization.AuthorizeAsync(User, "RoomIndex")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("RoomIndex","Room")" class="nav-link">
                                                <i class="fas fa-globe nav-icon"></i>
                                                <p>Room</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>
                        }


                        @if ((await authorization.AuthorizeAsync(User, "Reservation")).Succeeded)
                        {

                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-sign-out-alt"></i>
                                    <p>
                                        Reservation
                                        <i class="right fas fa-angle-left"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    @if ((await authorization.AuthorizeAsync(User, "BookingOverview")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexReservationManage","ReservationInfo")" class="nav-link">
                                                <i class="fas fa-gears nav-icon"></i>
                                                <p>Manage Bookings</p>
                                            </a>
                                        </li>
                                    }

                                    @if ((await authorization.AuthorizeAsync(User, "BookingOverview")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("ReservationIndex","Reservation")" class="nav-link">
                                                <i class="fas fa-globe nav-icon"></i>
                                                <p>Booking Overview</p>
                                            </a>
                                        </li>
                                    }

                                    @if ((await authorization.AuthorizeAsync(User, "RoomBooking")).Succeeded)
                                    {

                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("IndexBookRooms","Reservation")" class="nav-link">
                                                <i class="fas fa-lock nav-icon"></i>
                                                <p>Book</p>
                                            </a>
                                        </li>
                                    }

                                    @if ((await authorization.AuthorizeAsync(User, "ViewReservationInfo")).Succeeded)
                                    {
                                        <li class="nav-item ml-4">
                                            <a href="@Url.Action("ReservationInfoIndex","ReservationInfo")" class="nav-link">
                                                <i class="fas fa-check-circle nav-icon"></i>
                                                <p>Reservation Info</p>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </li>

                        }

                    </ul>
                </nav>
            </div>
        </aside>

        <div class="content-wrapper">
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <div>
                                <h1 class="m-0 text-dark" style="display: inline-block">@ViewBag.View</h1>
                                <span id="countSpan" class="badge badge-info" style="vertical-align: top">@ViewBag.Count</span>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            @Html.BuildBreadcrumbNavigation()
                        </div>
                    </div>
                </div>
            </div>

            <section class="content">
                <div class="container-fluid">
                    @RenderBody()
                </div>
            </section>

        </div>

        <footer class="main-footer">
            <div class="float-right">
                <b>Version</b> 1.6.5.10
            </div>
            <div>
                <strong>Copyright &copy; 2019-@DateTime.Now.Year <a href="https://www.facebook.com/WisdomKalutara" target="_blank">WISDOM Solutions</a></strong> All rights reserved.
            </div>
        </footer>

        <aside class="control-sidebar control-sidebar-dark">
        </aside>
    </div>

    <script>
        /** add active class and stay opened when selected */
        var url = window.location;

        // for sidebar menu entirely but not cover treeview
        $('ul.nav-treeview a').filter(function () {
            return this.href == url;
        }).addClass('active');


        // for treeview
        $('ul.nav-treeview a').filter(function () {
            return this.href == url;
        }).parentsUntil(".nav-sidebar > .nav-treeview").addClass('menu-open').prev('a').addClass('active');

    </script>


    @RenderSection("scripts", required: false)

</body>
</html>

